{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile in the Skill Garden application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "userName": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "dateJoined": {
          "type": "string",
          "description": "The date and time the user joined the Skill Garden.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userName",
        "email",
        "dateJoined"
      ]
    },
    "SkillGarden": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SkillGarden",
      "type": "object",
      "description": "Represents the user's skill garden, containing stems and leaves (skills).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the skill garden."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:1 SkillGarden)"
        },
        "name": {
          "type": "string",
          "description": "The name of the skill garden."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the skill garden."
        }
      },
      "required": [
        "id",
        "userId",
        "name"
      ]
    },
    "Stem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Stem",
      "type": "object",
      "description": "Represents a stem in the skill garden, used to organize related skills.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the stem."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Stem)"
        },
        "name": {
          "type": "string",
          "description": "The name of the stem."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the stem."
        }
      },
      "required": [
        "id",
        "userId",
        "name"
      ]
    },
    "Leaf": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Leaf",
      "type": "object",
      "description": "Represents a leaf (skill) in the skill garden.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the leaf."
        },
        "stemId": {
          "type": "string",
          "description": "Reference to Stem. (Relationship: Stem 1:N Leaf)"
        },
        "name": {
          "type": "string",
          "description": "The name of the skill (leaf)."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the skill."
        },
        "bloomed": {
          "type": "boolean",
          "description": "Indicates whether the skill is 'bloomed' (mastered)."
        },
        "notes": {
          "type": "string",
          "description": "Notes related to the skill."
        },
        "links": {
          "type": "array",
          "description": "Links to resources related to the skill.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "stemId",
        "name"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/profile",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. Only the authenticated user can read/write their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/stems/{stemId}",
        "definition": {
          "entityName": "Stem",
          "schema": {
            "$ref": "#/backend/entities/Stem"
          },
          "description": "Stores stem information for a specific user. Only the authenticated user can read/write their own stems.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "stemId",
              "description": "The unique identifier of the stem."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/stems/{stemId}/leaves/{leafId}",
        "definition": {
          "entityName": "Leaf",
          "schema": {
            "$ref": "#/backend/entities/Leaf"
          },
          "description": "Stores leaf (skill) information for a specific stem. Only the authenticated user can read/write leaves within their stems.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "stemId",
              "description": "The unique identifier of the stem."
            },
            {
              "name": "leafId",
              "description": "The unique identifier of the leaf."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure security, scalability, and ease of debugging. User profiles, stems, and leaves are organized into distinct collections with clear ownership. This avoids complex rule logic. Authorization is achieved by using path-based ownership for user-specific data (e.g., /users/{userId}/...), simplifying security rules and allowing for atomic operations."
  }
}
